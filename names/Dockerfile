FROM node:9

WORKDIR /usr/src/app
COPY . .
RUN npm install
RUN npm test

ARG AUTH0_ISSUER
ENV AUTH0_ISSUER ${AUTH0_ISSUER}

ARG AUTH0_ALGOS
ENV AUTH0_ALGOS ${AUTH0_ALGOS}

ARG AUTH0_URI
ENV AUTH0_URI ${AUTH0_URI}

ARG PORT
ENV PORT ${PORT}
EXPOSE ${PORT}

CMD ["npm", "start"]
